<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>COVID19 Tracker Application</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

    <!-- DataTables -->
    <link href="plugins/datatables/dataTables.bootstrap4.min.css" rel="stylesheet" type="text/css"/>
    <link href="plugins/datatables/buttons.bootstrap4.min.css" rel="stylesheet" type="text/css"/>
    <!-- Responsive datatable examples -->
    <link href="plugins/datatables/responsive.bootstrap4.min.css" rel="stylesheet" type="text/css"/>
    <!-- Multi Item Selection examples -->
    <link href="plugins/datatables/select.bootstrap4.min.css" rel="stylesheet" type="text/css"/>

    <!-- App css -->
    <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
    <link href="css/icons.css" rel="stylesheet" type="text/css"/>
    <link href="css/style.css" rel="stylesheet" type="text/css"/>

    <script src="js/modernizr.min.js"></script>

    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css"/>
    <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
    <script src="http://www.webglearth.com/v2/api.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="custom/custom.css" type="text/css">

</head>

<body>
<div class="container-fluid">

        <div class="label-counter" id="page-top">COVID-19 Coronavirus Pandemic</div>

    <div class="jumbotron"
         style="background: rgb(2,0,36); background: linear-gradient(90deg, rgba(2,0,36,1) 0%, rgba(9,9,121,1) 43%, rgba(0,212,255,1) 100%); color: white">

        <iframe scrolling="no" frameborder="no" clocktype="html5"
                style="overflow:hidden;border:0;margin:0;padding:0;width:235px;height:45px;"
                src="https://www.clocklink.com/html5embed.php?clock=sdt&timezone=Bangladesh_Dhaka&color=blue&size=235&Title=&Message=&Target=&From=2020,1,1,0,0,0&Color=blue"></iframe>
        <div class="row" style="color: black">

            <!--division for confirmed data-->
            <div class="col-md">
                <div class="card" style="border-radius: 20px">
                    <div class="card-body">
                        <p>Total Confirmed</p>
                        <h1 class="display-4" th:text="${totalReportedCases}"></h1>
                        <hr class="my-4">
                        <p>New Cases since Yesterday</p>
                        <h2 class="display-4" th:text="${totalNewCases}"></h2>
                    </div>
                </div>
            </div>

            <!-- division for recovered data-->
            <div class="col-md">
                <div class="card" style="border-radius: 20px">
                    <div class="card-body">
                        <p>Total Recovered</p>
                        <h1 class="display-4" th:text="${totalRecoveredStats}"></h1>
                        <hr class="my-4">
                        <p>New Recovered Cases since Yesterday</p>
                        <h2 class="display-4" th:text="${prevRecoveredStas}"></h2>
                    </div>
                </div>
            </div>

            <!-- division for Death Data-->
            <div class="col-md">
                <div class="card" style="border-radius: 20px">
                    <div class="card-body">
                        <p>Total Death</p>
                        <h1 class="display-4" th:text="${totalDeathStats}"></h1>
                        <hr class="my-4">
                        <p>New Death Cases since Yesterday</p>
                        <h2 class="display-4" th:text="${prevDeathStats}"></h2>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--    table for confirmed data table-->

    <div class="jumbotron" style="background: aliceblue">

        <h1>Total Confirmed Cases</h1>

        <table id="datatable-buttons" class="table table-striped table-bordered" cellspacing="0" width="100%">
            <thead style="background: rgb(2,0,36); background: linear-gradient(90deg, rgba(2,0,36,1) 0%, rgb(9,9,121) 43%, rgba(0,212,255,1) 100%); color: white">
            <tr>
                <th>State</th>
                <th>Country</th>
                <th>Latitude</th>
                <th>Longitude</th>
                <th>Total Confirmed Cases</th>
                <th>Changes Since Last Day</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="locationStat : ${locationStats}">
                <td th:text="${locationStat.state}"></td>
                <td th:text="${locationStat.country}"></td>
                <td th:text="${locationStat.lat}"></td>
                <td th:text="${locationStat.lon}"></td>
                <td th:text="${locationStat.latestTotalCases}">0</td>
                <td th:text="${locationStat.diffFromPrevDay}">0</td>
            </tr>
            </tbody>
        </table>
    </div>

    <!--    table for death data table-->
    <div class="jumbotron" style="background: aliceblue">
        <h1>Total Recovered Cases</h1>
        <table id="datatable" class="table table-striped table-bordered" cellspacing="0" width="100%">
            <thead style="background: rgb(2,0,36); background: linear-gradient(90deg, rgba(2,0,36,1) 0%, rgb(9,9,121) 43%, rgba(0,212,255,1) 100%); color: white">
            <tr>
                <th>State</th>
                <th>Country</th>
                <th>Total Recovered</th>
                <th>Changes since Last Day</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="recovere : ${recovered}">
                <td th:text="${recovere.recover_State}"></td>
                <td th:text="${recovere.recover_Country}"></td>
                <td th:text="${recovere.latestRecoveredCases}"></td>
                <td th:text="${recovere.diffFromPrevRecovered}"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <!--    table for death data table-->
    <div class="jumbotron" style="background: aliceblue">
        <h1>Total Death Cases</h1>
        <table id="responsive-datatable" class="table table-striped table-bordered" cellspacing="0" width="100%">
            <thead style="background: rgb(2,0,36); background: linear-gradient(90deg, rgba(2,0,36,1) 0%, rgb(9,9,121) 43%, rgba(0,212,255,1) 100%); color: white">
            <tr>
                <th>State</th>
                <th>Country</th>
                <th>Total Death</th>
                <th>Changes since Last Day</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="deaths : ${death}">
                <td th:text="${deaths.death_State}"></td>
                <td th:text="${deaths.death_Country}"></td>
                <td th:text="${deaths.lastestDeathCases}"></td>
                <td th:text="${deaths.diffFromPrevDeath}"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <div id="earth_div" class="d-none d-sm-none d-md-block"></div>
    <script th:inline="javascript">

        var options = {atmosphere: true, center: [0, 0], zoom: 0};
        var earth = new WE.map('earth_div', options);
        WE.tileLayer('http://tileserver.maptiler.com/nasa/{z}/{x}/{y}.jpg', {
            minZoom: 0,
            maxZoom: 5,
            attribution: 'COVID19'
        }).addTo(earth);

        var data = [[${locationStats}]];
        console.log("list: " + data.length);
        for (var i = 0; i < data.length; i++) {
            if (data[i].lat !== null && data[i].lon !== "") {
                WE.marker([data[i].lat, data[i].lon]).addTo(earth)
                    .bindPopup(
                        "State: " + data[i].state + '<br><b>'
                        + "Country: " + data[i].country + '<br><b>'
                        + "Total Confirmed Cases: " + data[i].latestTotalCases + '<br></b>'
                        + "Difference From Yesterday: " + data[i].diffFromPrevDay + '</b>'
                    )

            }
        }

    </script>

    <div id="mapid" style="width: 100%; height: 750px;" class="d-none d-sm-block d-md-none"></div>
    <script th:inline="javascript">

        var mymap = L.map('mapid').setView([23.685, 90.3563], 4);

        L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
            attribution: 'COVID19'
        }).addTo(mymap);

        var data = [[${locationStats}]] ;
        console.log("list: "+ data.length);
        for(var i=0; i< data.length;i++) {
            if(data[i].lat !== null && data[i].lon !== "") {
                L.marker([data[i].lat, data[i].lon]).addTo(mymap)
                    .bindPopup(
                        "State: "+ data[i].state+'<br><b>'
                        +"Country: "+data[i].country+'<br><b>'
                        +"Total Confirmed Cases: " +data[i].latestTotalCases+'</b>'
                    )
                    .openPopup();
            }
        }
    </script>

</div>

<script src="js/jquery.min.js"></script>
<script src="js/popper.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/detect.js"></script>
<script src="js/fastclick.js"></script>
<script src="js/jquery.blockUI.js"></script>
<script src="js/waves.js"></script>
<script src="js/jquery.nicescroll.js"></script>
<script src="js/jquery.slimscroll.js"></script>
<script src="js/jquery.scrollTo.min.js"></script>

<!-- Required datatable js -->
<script src="plugins/datatables/jquery.dataTables.min.js"></script>
<script src="plugins/datatables/dataTables.bootstrap4.min.js"></script>
<!-- Buttons examples -->
<script src="plugins/datatables/dataTables.buttons.min.js"></script>
<script src="plugins/datatables/buttons.bootstrap4.min.js"></script>
<script src="plugins/datatables/jszip.min.js"></script>
<script src="plugins/datatables/pdfmake.min.js"></script>
<script src="plugins/datatables/vfs_fonts.js"></script>
<script src="plugins/datatables/buttons.html5.min.js"></script>
<script src="plugins/datatables/buttons.print.min.js"></script>

<!-- Key Tables -->
<script src="plugins/datatables/dataTables.keyTable.min.js"></script>

<!-- Responsive examples -->
<script src="plugins/datatables/dataTables.responsive.min.js"></script>
<script src="plugins/datatables/responsive.bootstrap4.min.js"></script>

<!-- Selection table -->
<script src="plugins/datatables/dataTables.select.min.js"></script>

<!-- App js -->
<script src="js/jquery.core.js"></script>
<script src="js/jquery.app.js"></script>

<script type="text/javascript">
    $(document).ready(function () {

        // Default Datatable
        $('#datatable').DataTable();

        //Buttons examples
        var table = $('#datatable-buttons').DataTable({
            lengthChange: false,
            buttons: ['copy', 'excel', 'pdf']
        });

        // Key Tables

        $('#key-table').DataTable({
            keys: true
        });

        // Responsive Datatable
        $('#responsive-datatable').DataTable();

        // Multi Selection Datatable
        $('#selection-datatable').DataTable({
            select: {
                style: 'multi'
            }
        });

        table.buttons().container()
            .appendTo('#datatable-buttons_wrapper .col-md-6:eq(0)');
    });

</script>

</body>


</html>